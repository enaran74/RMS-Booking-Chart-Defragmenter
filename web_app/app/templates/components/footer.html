<!-- Session Timer (left side) -->
<div class="session-timer" id="sessionTimer" style="display: none;">
  <i class="fas fa-clock me-1"></i>
  <span id="sessionCountdown">29:59</span>
</div>

<!-- Version Stamp (right side) -->
<div class="version-stamp" id="versionStamp">RMS Defragmenter • loading...</div>
<style>
  .version-stamp{
    position: fixed;
    right: 12px;
    bottom: 10px;
    font-size: 11px;
    color: #6c757d;
    background: rgba(255,255,255,0.85);
    border: 1px solid rgba(0,0,0,0.05);
    border-radius: 6px;
    padding: 4px 8px;
    z-index: 1040;
    pointer-events: none;
  }
  .session-timer{
    position: fixed;
    left: 12px;
    bottom: 10px;
    font-size: 11px;
    color: #6c757d;
    background: rgba(255,255,255,0.9);
    border: 1px solid rgba(0,0,0,0.1);
    border-radius: 6px;
    padding: 4px 8px;
    z-index: 1040;
    pointer-events: none;
    transition: color 0.3s ease;
  }
  .session-timer.warning{
    color: #fd7e14;
    border-color: rgba(253, 126, 20, 0.2);
    background: rgba(255, 243, 205, 0.9);
  }
  .session-timer.danger{
    color: #dc3545;
    border-color: rgba(220, 53, 69, 0.2);
    background: rgba(248, 215, 218, 0.9);
    animation: pulse 1s infinite;
  }
  @keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.7; }
    100% { opacity: 1; }
  }
  .version-stamp .badge{ margin-left:6px; }
</style>
<script>
  (function(){
    try{
      var el = document.getElementById('versionStamp');
      if(!el) return;
      
      // Fetch dynamic version from API
      fetch('/api/v1/version')
        .then(response => response.json())
        .then(data => {
          var ts = new Date(data.timestamp || Date.now());
          el.textContent = 'RMS Defragmenter ' + data.version + ' • loaded ' + ts.toLocaleString();
          
          // Append TRAINING indicator if present on window or meta
          var training = (window.APP_USE_TRAINING_DB === true);
          try{
            var meta = document.querySelector('meta[name="use-training-db"]');
            if(meta){
              var c = (meta.content || '').toString().trim().toLowerCase();
              training = (c === 'true' || c === '1' || c === 'yes');
              // expose for any other scripts
              window.APP_USE_TRAINING_DB = training;
            }
          }catch(e){}
          
          if(training){
            var b = document.createElement('span');
            b.className = 'badge bg-warning text-dark';
            b.textContent = 'TRAINING';
            el.appendChild(b);
          } else {
            var b = document.createElement('span');
            b.className = 'badge bg-success';
            b.textContent = 'LIVE';
            el.appendChild(b);
          }
        })
        .catch(err => {
          // Fallback to static version with timestamp
          var ts = new Date(document.lastModified || Date.now());
          el.textContent = 'RMS Defragmenter v1.0.0 • loaded ' + ts.toLocaleString();
          console.warn('Failed to fetch version:', err);
        });
        
    }catch(e){
      console.warn('Version stamp initialization failed:', e);
    }
  })();
</script>

